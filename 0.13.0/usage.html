<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Apache log4cxx: Usage</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Apache log4cxx
   &#160;<span id="projectnumber">Version 0.13.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('usage.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Usage </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#loggers">Loggers</a><ul><li class="level2"><a href="#hierarchy">Hierarchy</a></li>
<li class="level2"><a href="#levels">Levels</a></li>
<li class="level2"><a href="#requests">Requests</a></li>
</ul>
</li>
<li class="level1"><a href="#appenders-and-layouts">Appenders and Layouts</a></li>
<li class="level1"><a href="#configuration">Configuration</a></li>
<li class="level1"><a href="#default-initialization-procedure">Default Initialization Procedure</a></li>
<li class="level1"><a href="#nested-diagnostic-contexts">Nested Diagnostic Contexts</a></li>
<li class="level1"><a href="#performance">Performance</a></li>
<li class="level1"><a href="#removing-log-statements">Removing log statements</a></li>
<li class="level1"><a href="#custom-types">Logging Custom Types</a></li>
<li class="level1"><a href="#logging-with-fmt">Logging with {fmt}</a></li>
<li class="level1"><a href="#filtering">Filtering Messages</a></li>
<li class="level1"><a href="#conclusions">Conclusions</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="loggers"></a>
Loggers</h1>
<p>Log4cxx has three main components: <em>loggers</em>, <em>appenders</em> and <em>layouts</em>. These three types of components work together to enable developers to log messages according to message type and level, and to control at runtime how these messages are formatted and where they are reported.</p>
<h2><a class="anchor" id="hierarchy"></a>
Hierarchy</h2>
<p>The first and foremost advantage of any logging API over plain <code>std::cout</code> resides in its ability to disable certain log statements while allowing others to print unhindered. This capability assumes that the logging space, that is, the space of all possible logging statements, is categorized according to some developer-chosen criteria.</p>
<p>Loggers are named entities. Logger names are case-sensitive and they follow the hierarchical naming rule:</p>
<p><b>Named Hierarchy</b></p>
<p>A logger is said to be an <em>ancestor</em> of another logger if its name followed by a dot is a prefix of the <em>descendant</em> logger name. A logger is said to be a <em>parent</em> of a <em>child</em> logger if there are no ancestors between itself and the descendant logger.</p>
<p>For example, the logger named <code>com.foo</code> is a parent of the logger named <code>com.foo.Bar</code>. Similarly, <code>java</code> is a parent of <code>java.util</code> and an ancestor of <code>java.util.Vector</code>. This naming scheme should be familiar to most developers.</p>
<p>The root logger resides at the top of the logger hierarchy. It is exceptional in two ways:</p>
<ol type="1">
<li>it always exists,</li>
<li>it cannot be retrieved by name.</li>
</ol>
<p>Invoking the class static <a class="el" href="classlog4cxx_1_1Logger.html#ac53c8f83b37b20ff4b18ee87b772be25" title="Retrieve the root logger. ">log4cxx::Logger::getRootLogger</a> method retrieves it. All other loggers are instantiated and retrieved with the class static <a class="el" href="classlog4cxx_1_1Logger.html#ab2d1e6be52dbe1bc81e01fd70a755a63" title="Retrieve a logger by name in current encoding. ">log4cxx::Logger::getLogger</a> method. This method takes the name of the desired logger as a parameter. Some of the basic methods in the Logger class are listed below.</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code" href="namespacelog4cxx.html">log4cxx</a> {</div><div class="line">    <span class="keyword">class </span>Logger {</div><div class="line">        <span class="keyword">public</span>:</div><div class="line">            <span class="comment">// Creation &amp; retrieval methods:</span></div><div class="line">            <span class="keyword">static</span> <a class="code" href="namespacelog4cxx.html#acd073adf77cc8545b10ac024a474be0d">LoggerPtr</a> <a class="code" href="classlog4cxx_1_1Logger.html#ac53c8f83b37b20ff4b18ee87b772be25">getRootLogger</a>();</div><div class="line">            <span class="keyword">static</span> <a class="code" href="namespacelog4cxx.html#acd073adf77cc8545b10ac024a474be0d">LoggerPtr</a> <a class="code" href="classlog4cxx_1_1Logger.html#ab2d1e6be52dbe1bc81e01fd70a755a63">getLogger</a>(<span class="keyword">const</span> std::string&amp; <a class="code" href="classlog4cxx_1_1Logger.html#af0e01519e1a01255bebf4075a772afa9">name</a>);</div><div class="line">            <span class="keyword">static</span> <a class="code" href="namespacelog4cxx.html#acd073adf77cc8545b10ac024a474be0d">LoggerPtr</a> <a class="code" href="classlog4cxx_1_1Logger.html#ab2d1e6be52dbe1bc81e01fd70a755a63">getLogger</a>(<span class="keyword">const</span> std::wstring&amp; <a class="code" href="classlog4cxx_1_1Logger.html#af0e01519e1a01255bebf4075a772afa9">name</a>);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Use these macros instead of calling Logger methods directly.</span></div><div class="line"><span class="comment">// Macros will handle char or wchar_t pointers or strings</span></div><div class="line"><span class="comment">// or most right-hand side expressions of an</span></div><div class="line"><span class="comment">// std::basic_string::operator&lt;&lt;.</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="preprocessor">#define LOG4CXX_TRACE(logger, expression) ...</span></div><div class="line"><span class="preprocessor">#define LOG4CXX_DEBUG(logger, expression) ...</span></div><div class="line"><span class="preprocessor">#define LOG4CXX_INFO(logger, expression) ...</span></div><div class="line"><span class="preprocessor">#define LOG4CXX_WARN(logger, expression) ...</span></div><div class="line"><span class="preprocessor">#define LOG4CXX_ERROR(logger, expression) ...</span></div><div class="line"><span class="preprocessor">#define LOG4CXX_FATAL(logger, expression) ...</span></div></div><!-- fragment --><h2><a class="anchor" id="levels"></a>
Levels</h2>
<p>Loggers <em>may</em> be assigned levels. The pre-defined levels: TRACE, DEBUG, INFO, WARN, ERROR and FATAL are defined in the <a class="el" href="classlog4cxx_1_1Level.html" title="Defines the minimum set of levels recognized by the system, that is OFF, FATAL, ERROR, WARN, INFO, DEBUG and ALL. ">log4cxx::Level</a> class which provides accessor functions.</p>
<p>If a given logger is not assigned a level, then it inherits one from its closest ancestor with an assigned level. More formally:</p>
<p><b>Level Inheritance</b></p>
<p>The <em>inherited level</em> for a given logger <em>C</em>, is equal to the first non-null level in the logger hierarchy, starting at <em>C</em> and proceeding upwards in the hierarchy towards the <em>root</em> logger.</p>
<p>To ensure that all loggers can eventually inherit a level, the root logger always has an assigned level.</p>
<p>Below are four tables with various assigned level values and the resulting inherited levels according to the above rule.</p>
<table class="doxtable">
<tr>
<th>Logger name </th><th>Assigned level </th><th>Inherited level  </th></tr>
<tr>
<td>root </td><td>Proot </td><td>Proot </td></tr>
<tr>
<td>X </td><td>none </td><td>Proot </td></tr>
<tr>
<td>X.Y </td><td>none </td><td>Proot </td></tr>
<tr>
<td>X.Y.Z </td><td>none </td><td>Proot </td></tr>
</table>
<p>Example 1</p>
<p>In example 1 above, only the root logger is assigned a level. This level value, <em>Proot</em>, is inherited by the other loggers <em>X</em>, <em>X.Y</em> and <em>X.Y.Z</em>.</p>
<table class="doxtable">
<tr>
<th>Logger name </th><th>Assigned level </th><th>Inherited level  </th></tr>
<tr>
<td>root </td><td>Proot </td><td>Proot </td></tr>
<tr>
<td>X </td><td>Px </td><td>Px </td></tr>
<tr>
<td>X.Y </td><td>Pxy </td><td>Pxy </td></tr>
<tr>
<td>X.Y.Z </td><td>Pxyz </td><td>Pxyz </td></tr>
</table>
<p>Example 2</p>
<p>In example 2, all loggers have an assigned level value. There is no need for level inheritence.</p>
<table class="doxtable">
<tr>
<th>Logger name </th><th>Assigned level </th><th>Inherited level  </th></tr>
<tr>
<td>root </td><td>Proot </td><td>Proot </td></tr>
<tr>
<td>X </td><td>Px </td><td>Px </td></tr>
<tr>
<td>X.Y </td><td>none </td><td>Px </td></tr>
<tr>
<td>X.Y.Z </td><td>Pxyz </td><td>Pxyz </td></tr>
</table>
<p>Example 3</p>
<p>In example 3, the loggers <em>root</em>, <em>X</em> and <em>X.Y.Z</em> are assigned the levels <em>Proot</em>, <em>Px</em> and <em>Pxyz</em> respectively. The logger <em>X.Y</em> inherits its level value from its parent <em>X</em>.</p>
<table class="doxtable">
<tr>
<th>Logger name </th><th>Assigned level </th><th>Inherited level  </th></tr>
<tr>
<td>root </td><td>Proot </td><td>Proot </td></tr>
<tr>
<td>X </td><td>Px </td><td>Px </td></tr>
<tr>
<td>X.Y </td><td>none </td><td>Px </td></tr>
<tr>
<td>X.Y.Z </td><td>none </td><td>Px </td></tr>
</table>
<p>Example 4</p>
<p>In example 4, the loggers <em>root</em> and <em>X</em> and are assigned the levels <em>Proot</em> and <em>Px</em> respectively. The loggers <em>X.Y</em> and <em>X.Y.Z</em> inherits their level value from their nearest parent <em>X</em> having an assigned level.</p>
<h2><a class="anchor" id="requests"></a>
Requests</h2>
<p>Logging requests are made by invoking a method of a logger instance, preferrably through the use of LOG4CXX_INFO or similar macros which support short-circuiting if the threshold is not satisfied and use of the insertion operator (&lt;&lt;) in the message parameter.</p>
<div class="fragment"><div class="line"><a class="code" href="namespacelog4cxx.html#acd073adf77cc8545b10ac024a474be0d">log4cxx::LoggerPtr</a> logger(<a class="code" href="classlog4cxx_1_1Logger.html#ab2d1e6be52dbe1bc81e01fd70a755a63">log4cxx::Logger::getLogger</a>(<span class="stringliteral">&quot;com.foo&quot;</span>));</div><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* region = <span class="stringliteral">&quot;World&quot;</span>;</div><div class="line"><a class="code" href="group__LoggingMacros.html#ga61dfed4f5eca82725a90a331f37857d3">LOG4CXX_INFO</a>(logger, <span class="stringliteral">&quot;Simple message text.&quot;</span>);</div><div class="line"><a class="code" href="group__LoggingMacros.html#ga61dfed4f5eca82725a90a331f37857d3">LOG4CXX_INFO</a>(logger, <span class="stringliteral">&quot;Hello, &quot;</span> &lt;&lt; region);</div><div class="line"><a class="code" href="group__LoggingMacros.html#gae1bc2ab20d5f2d7660995ea8244d3a26">LOG4CXX_DEBUG</a>(logger, L<span class="stringliteral">&quot;Iteration &quot;</span> &lt;&lt; i);</div><div class="line"><a class="code" href="group__LoggingMacros.html#gae1bc2ab20d5f2d7660995ea8244d3a26">LOG4CXX_DEBUG</a>(logger, <span class="stringliteral">&quot;e^10 = &quot;</span> &lt;&lt; std::scientific &lt;&lt; exp(10.0));</div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Use a wchar_t first operand to force use of wchar_t based stream.</span></div><div class="line"><span class="comment">//</span></div><div class="line"><a class="code" href="group__LoggingMacros.html#ga530190bc1766b89d1f69ad572509aed2">LOG4CXX_WARN</a>(logger, L<span class="stringliteral">&quot;&quot;</span> &lt;&lt; i &lt;&lt; L<span class="stringliteral">&quot; is the number of the iteration.&quot;</span>);</div></div><!-- fragment --><p>A logging request is said to be <em>enabled</em> if its level is higher than or equal to the level of its logger. Otherwise, the request is said to be <em>disabled</em>. A logger without an assigned level will inherit one from the hierarchy. This rule is summarized below.</p>
<p><b>Basic Selection Rule</b></p>
<p>A log request of level <em>p</em> in a logger with (either assigned or inherited, whichever is appropriate) level <em>q</em>, is enabled if <em>p &gt;= q</em>.</p>
<p>This rule is at the heart of <a class="el" href="namespacelog4cxx.html">log4cxx</a>. It assumes that levels are ordered. For the standard levels, we have <em>TRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATAL</em>.</p>
<p>Here is an example of this rule.</p>
<div class="fragment"><div class="line"><span class="comment">// get a logger instance named &quot;com.foo&quot;</span></div><div class="line"><a class="code" href="namespacelog4cxx.html#acd073adf77cc8545b10ac024a474be0d">log4cxx::LoggerPtr</a>  logger(<a class="code" href="classlog4cxx_1_1Logger.html#ab2d1e6be52dbe1bc81e01fd70a755a63">log4cxx::Logger::getLogger</a>(<span class="stringliteral">&quot;com.foo&quot;</span>));</div><div class="line"></div><div class="line"><span class="comment">// Now set its level. Normally you do not need to set the</span></div><div class="line"><span class="comment">// level of a logger programmatically. This is usually done</span></div><div class="line"><span class="comment">// in configuration files.</span></div><div class="line">logger-&gt;setLevel(<a class="code" href="classlog4cxx_1_1Level.html#ab7c74df8715d5009b3d9f06658d19847">log4cxx::Level::getInfo</a>());</div><div class="line"></div><div class="line"><a class="code" href="namespacelog4cxx.html#acd073adf77cc8545b10ac024a474be0d">log4cxx::LoggerPtr</a> barlogger(<a class="code" href="classlog4cxx_1_1Logger.html#ab2d1e6be52dbe1bc81e01fd70a755a63">log4cxx::Logger::getLogger</a>(<span class="stringliteral">&quot;com.foo.Bar&quot;</span>));</div><div class="line"></div><div class="line"><span class="comment">// This request is enabled, because WARN &gt;= INFO.</span></div><div class="line"><a class="code" href="group__LoggingMacros.html#ga530190bc1766b89d1f69ad572509aed2">LOG4CXX_WARN</a>(logger, <span class="stringliteral">&quot;Low fuel level.&quot;</span>);</div><div class="line"></div><div class="line"><span class="comment">// This request is disabled, because DEBUG &lt; INFO.</span></div><div class="line"><a class="code" href="group__LoggingMacros.html#gae1bc2ab20d5f2d7660995ea8244d3a26">LOG4CXX_DEBUG</a>(logger, <span class="stringliteral">&quot;Starting search for nearest gas station.&quot;</span>);</div><div class="line"></div><div class="line"><span class="comment">// The logger instance barlogger, named &quot;com.foo.Bar&quot;,</span></div><div class="line"><span class="comment">// will inherit its level from the logger named</span></div><div class="line"><span class="comment">// &quot;com.foo&quot; Thus, the following request is enabled</span></div><div class="line"><span class="comment">// because INFO &gt;= INFO.</span></div><div class="line"><a class="code" href="group__LoggingMacros.html#ga61dfed4f5eca82725a90a331f37857d3">LOG4CXX_INFO</a>(barlogger. <span class="stringliteral">&quot;Located nearest gas station.&quot;</span>);</div><div class="line"></div><div class="line"><span class="comment">// This request is disabled, because DEBUG &lt; INFO.</span></div><div class="line"><a class="code" href="group__LoggingMacros.html#gae1bc2ab20d5f2d7660995ea8244d3a26">LOG4CXX_DEBUG</a>(barlogger, <span class="stringliteral">&quot;Exiting gas station search&quot;</span>);</div></div><!-- fragment --><p>Calling the <em>getLogger</em> method with the same name will always return a reference to the exact same logger object.</p>
<p>For example, in</p>
<div class="fragment"><div class="line"><a class="code" href="namespacelog4cxx.html#acd073adf77cc8545b10ac024a474be0d">log4cxx::LoggerPtr</a> x = <a class="code" href="classlog4cxx_1_1Logger.html#ab2d1e6be52dbe1bc81e01fd70a755a63">log4cxx::Logger::getLogger</a>(<span class="stringliteral">&quot;wombat&quot;</span>);</div><div class="line"><a class="code" href="namespacelog4cxx.html#acd073adf77cc8545b10ac024a474be0d">log4cxx::LoggerPtr</a> y = <a class="code" href="classlog4cxx_1_1Logger.html#ab2d1e6be52dbe1bc81e01fd70a755a63">log4cxx::Logger::getLogger</a>(<span class="stringliteral">&quot;wombat&quot;</span>);</div></div><!-- fragment --><p><em>x</em> and <em>y</em> refer to <em>exactly</em> the same logger object.</p>
<p>Thus, it is possible to configure a logger and then to retrieve the same instance somewhere else in the code without passing around references. In fundamental contradiction to biological parenthood, where parents always preceed their children, <a class="el" href="namespacelog4cxx.html">log4cxx</a> loggers can be created and configured in any order. In particular, a "parent" logger will find and link to its descendants even if it is instantiated after them.</p>
<p>Configuration of the <a class="el" href="namespacelog4cxx.html">log4cxx</a> environment is typically done at application initialization. The preferred way is by reading a configuration file. This approach will be discussed shortly.</p>
<p>Log4cxx makes it easy to name loggers by <em>software component</em>. This can be accomplished by statically instantiating a logger in each class, with the logger name equal to the fully qualified name of the class. This is a useful and straightforward method of defining loggers. As the log output bears the name of the generating logger, this naming strategy makes it easy to identify the origin of a log message. However, this is only one possible, albeit common, strategy for naming loggers. Log4cxx does not restrict the possible set of loggers. The developer is free to name the loggers as desired.</p>
<p>Nevertheless, naming loggers after the class where they are located seems to be the best strategy known so far.</p>
<h1><a class="anchor" id="appenders-and-layouts"></a>
Appenders and Layouts</h1>
<p>The ability to selectively enable or disable logging requests based on their logger is only part of the picture. Log4cxx allows logging requests to print to multiple destinations. In <a class="el" href="namespacelog4cxx.html">log4cxx</a> speak, an output destination is called an <em>appender</em>. Currently, appenders exist for the <a class="el" href="classlog4cxx_1_1ConsoleAppender.html">console</a>, <a class="el" href="classlog4cxx_1_1FileAppender.html">files</a>, GUI components, <a class="el" href="classlog4cxx_1_1net_1_1SocketAppender.html">remote socket</a> servers, <a class="el" href="classlog4cxx_1_1nt_1_1NTEventLogAppender.html">NT Event Loggers</a>, and remote UNIX <a class="el" href="classlog4cxx_1_1net_1_1SyslogAppender.html">Syslog</a> daemons. It is also possible to log <a class="el" href="classlog4cxx_1_1AsyncAppender.html">asynchronously</a>.</p>
<p>More than one appender can be attached to a logger.</p>
<p>The <a class="el" href="classlog4cxx_1_1Logger.html#aa8435b5902f827ffed33ea33fd484fd9">addAppender</a> method adds an appender to a given logger. <em>Each enabled logging request for a given logger will be forwarded to all the appenders in that logger as well as the appenders higher in the hierarchy.</em> In other words, appenders are inherited additively from the logger hierarchy. For example, if a console appender is added to the root logger, then all enabled logging requests will at least print on the console. If in addition a file appender is added to a logger, say <em>C</em>, then enabled logging requests for <em>C</em> and <em>C</em>'s children will print on a file <em>and</em> on the console. It is possible to override this default behavior so that appender accumulation is no longer additive by <a class="el" href="classlog4cxx_1_1Logger.html#a05bf2d4cbe5cb66cde38c8fa5c1f0fe4">setting the additivity flag</a> to <code>false</code>.</p>
<p>The rules governing appender additivity are summarized below.</p>
<p><b>Appender Additivity</b></p>
<p>The output of a log statement of logger <em>C</em> will go to all the appenders in <em>C</em> and its ancestors. This is the meaning of the term "appender
additivity". However, if an ancestor of logger <em>C</em>, say <em>P</em>, has the additivity flag set to <em>false</em>, then <em>C</em>'s output will be directed to all the appenders in <em>C</em> and it's ancestors up to and including <em>P</em> but, not the appenders in any of the ancestors of <em>P</em>.</p>
<p>Loggers have their additivity flag set to <em>true</em> by default.</p>
<p>The table below shows an example:</p>
<table class="doxtable">
<tr>
<th>Logger Name </th><th>Added Appenders </th><th>Additivity Flag </th><th>Output Targets </th><th>Comment  </th></tr>
<tr>
<td>root </td><td>A1 </td><td>not applicable </td><td>A1 </td><td>The root logger is anonymous but can be accessed with the <a class="el" href="classlog4cxx_1_1Logger.html#ac53c8f83b37b20ff4b18ee87b772be25" title="Retrieve the root logger. ">log4cxx::Logger::getRootLogger()</a> method. There is no default appender attached to root. </td></tr>
<tr>
<td>x </td><td>A-x1, A-x2 </td><td>true </td><td>A1, A-x1, A-x2 </td><td>Appenders of "x" and root. </td></tr>
<tr>
<td>x.y </td><td>none </td><td>true </td><td>A1, A-x1, A-x2 </td><td>Appenders of "x" and root. </td></tr>
<tr>
<td>x.y.z </td><td>A-xyz1 </td><td>true </td><td>A1, A-x1, A-x2, A-xyz1 </td><td>Appenders in "x.y.z", "x" and root. </td></tr>
<tr>
<td>security </td><td>A-sec </td><td>false </td><td>A-sec </td><td>No appender accumulation since the additivity flag is set to <em>false</em>. </td></tr>
<tr>
<td>security.access </td><td>none </td><td>true </td><td>A-sec </td><td>Only appenders of "security" because the additivity flag in "security" is set to <em>false</em>. </td></tr>
</table>
<p>More often than not, users wish to customize not only the output destination but also the output format. This is accomplished by associating a <em>layout</em> with an appender. The layout is responsible for formatting the logging request according to the user's wishes, whereas an appender takes care of sending the formatted output to its destination.</p>
<p>The <a class="el" href="classlog4cxx_1_1PatternLayout.html">PatternLayout</a>, part of the standard <a class="el" href="namespacelog4cxx.html">log4cxx</a> distribution, lets the user specify the output format according to conversion patterns similar to the C language <em>printf</em> function.</p>
<p>For example, the PatternLayout with the conversion pattern <code>%r [%t] %%-5p %c - %m%n</code> will output something akin to:</p>
<div class="fragment"><div class="line">176 [main] INFO org.foo.Bar - Located nearest gas station.</div></div><!-- fragment --><p>The first field is the number of milliseconds elapsed since the start of the program. The second field is the thread making the log request. The third field is the level of the log statement. The fourth field is the name of the logger associated with the log request. The text after the '-' is the message of the statement.</p>
<h1><a class="anchor" id="configuration"></a>
Configuration</h1>
<p>Inserting log requests into the application code requires a fair amount of planning and effort. Observation shows that approximately 4 percent of code is dedicated to logging. Consequently, even moderately sized applications will have thousands of logging statements embedded within their code. Given their number, it becomes imperative to manage these log statements without the need to modify them manually.</p>
<p>The <a class="el" href="namespacelog4cxx.html">log4cxx</a> environment is fully configurable programmatically. However, it is far more flexible to configure <a class="el" href="namespacelog4cxx.html">log4cxx</a> using configuration files. Currently, configuration files can be written in XML or in Java properties (key=value) format.</p>
<p>Let us give a taste of how this is done with the help of an imaginary application <em>MyApp</em> that uses <a class="el" href="namespacelog4cxx.html">log4cxx</a>.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;com/foo/bar.h&quot;</span></div><div class="line"><span class="keyword">using namespace </span>com::foo;</div><div class="line"></div><div class="line"><span class="comment">// include log4cxx header files.</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="logger_8h.html">log4cxx/logger.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="basicconfigurator_8h.html">log4cxx/basicconfigurator.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="exception_8h.html">log4cxx/helpers/exception.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacelog4cxx.html">log4cxx</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacelog4cxx_1_1helpers.html">log4cxx::helpers</a>;</div><div class="line"></div><div class="line"><a class="code" href="namespacelog4cxx.html#acd073adf77cc8545b10ac024a474be0d">LoggerPtr</a> logger(Logger::getLogger(<span class="stringliteral">&quot;MyApp&quot;</span>));</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div><div class="line">{</div><div class="line">    <span class="keywordtype">int</span> result = EXIT_SUCCESS;</div><div class="line">    <span class="keywordflow">try</span></div><div class="line">    {</div><div class="line">        <span class="comment">// Set up a simple configuration that logs on the console.</span></div><div class="line">        BasicConfigurator::configure();</div><div class="line"></div><div class="line">        <a class="code" href="group__LoggingMacros.html#ga61dfed4f5eca82725a90a331f37857d3">LOG4CXX_INFO</a>(logger, <span class="stringliteral">&quot;Entering application.&quot;</span>);</div><div class="line">        Bar bar;</div><div class="line">        bar.doIt();</div><div class="line">        <a class="code" href="group__LoggingMacros.html#ga61dfed4f5eca82725a90a331f37857d3">LOG4CXX_INFO</a>(logger, <span class="stringliteral">&quot;Exiting application.&quot;</span>);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">catch</span>(<a class="code" href="classlog4cxx_1_1helpers_1_1Exception.html">Exception</a>&amp;)</div><div class="line">    {</div><div class="line">        result = EXIT_FAILURE;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> result;</div><div class="line">}</div></div><!-- fragment --><p><em>MyApp</em> begins by including <a class="el" href="namespacelog4cxx.html">log4cxx</a> headers. It then defines a static logger variable with the name <em>MyApp</em> which happens to be the fully qualified name of the class.</p>
<p><em>MyApp</em> uses the <em>Bar</em> class defined in header file <em>com/foo/bar.h</em>.</p>
<div class="fragment"><div class="line"><span class="comment">// file com/foo/bar.h</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="logger_8h.html">log4cxx/logger.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">namespace </span>com {</div><div class="line">    <span class="keyword">namespace </span>foo {</div><div class="line">        <span class="keyword">class </span>Bar {</div><div class="line">            <span class="keyword">static</span> <a class="code" href="namespacelog4cxx.html#acd073adf77cc8545b10ac024a474be0d">log4cxx::LoggerPtr</a> logger;</div><div class="line"></div><div class="line">            <span class="keyword">public</span>:</div><div class="line">                <span class="keywordtype">void</span> doIt();</div><div class="line">        };</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// file bar.cpp</span></div><div class="line"><span class="preprocessor">#include &quot;com/foo/bar.h&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span>com::foo;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacelog4cxx.html">log4cxx</a>;</div><div class="line"></div><div class="line"><a class="code" href="namespacelog4cxx.html#acd073adf77cc8545b10ac024a474be0d">LoggerPtr</a> Bar::logger(Logger::getLogger(<span class="stringliteral">&quot;com.foo.bar&quot;</span>));</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> Bar::doIt() {</div><div class="line">    <a class="code" href="group__LoggingMacros.html#gae1bc2ab20d5f2d7660995ea8244d3a26">LOG4CXX_DEBUG</a>(logger, <span class="stringliteral">&quot;Did it again!&quot;</span>);</div><div class="line">}</div></div><!-- fragment --><p>The invocation of the <a class="el" href="classlog4cxx_1_1BasicConfigurator.html#aa00e628d72f530941c6fa31c3fcc85b8">BasicConfigurator::configure</a> method creates a rather simple <a class="el" href="namespacelog4cxx.html">log4cxx</a> setup. This method is hardwired to add to the root logger a <a class="el" href="classlog4cxx_1_1ConsoleAppender.html">ConsoleAppender</a>. The output will be formatted using a <a class="el" href="classlog4cxx_1_1PatternLayout.html">PatternLayout</a> set to the pattern <code>%%-4r [%t] %%-5p %c %x - %m%n</code>.</p>
<p>Note that by default, the root logger is assigned to <em>Level::getDebug()</em>.</p>
<p>The output of MyApp is:</p>
<div class="fragment"><div class="line">0    [12345] INFO  MyApp  - Entering application.</div><div class="line">36   [12345] DEBUG com.foo.Bar  - Did it again!</div><div class="line">51   [12345] INFO  MyApp  - Exiting application.</div></div><!-- fragment --><p>The previous example always outputs the same log information. Fortunately, it is easy to modify <em>MyApp</em> so that the log output can be controlled at run-time. Here is a slightly modified version.</p>
<div class="fragment"><div class="line"><span class="comment">// file MyApp2.cpp</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;com/foo/bar.h&quot;</span></div><div class="line"><span class="keyword">using namespace </span>com::foo;</div><div class="line"></div><div class="line"><span class="comment">// include log4cxx header files.</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="logger_8h.html">log4cxx/logger.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="basicconfigurator_8h.html">log4cxx/basicconfigurator.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="propertyconfigurator_8h.html">log4cxx/propertyconfigurator.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="exception_8h.html">log4cxx/helpers/exception.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacelog4cxx.html">log4cxx</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacelog4cxx_1_1helpers.html">log4cxx::helpers</a>;</div><div class="line"><span class="comment">// Define a static logger variable so that it references the</span></div><div class="line"><span class="comment">// Logger instance named &quot;MyApp&quot;.</span></div><div class="line"><a class="code" href="namespacelog4cxx.html#acd073adf77cc8545b10ac024a474be0d">LoggerPtr</a> logger(Logger::getLogger(<span class="stringliteral">&quot;MyApp&quot;</span>));</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div><div class="line">{</div><div class="line">    <span class="keywordtype">int</span> result = EXIT_SUCCESS;</div><div class="line">    <span class="keywordflow">try</span></div><div class="line">    {</div><div class="line">        <span class="keywordflow">if</span> (argc &gt; 1)</div><div class="line">        {</div><div class="line">            <span class="comment">// BasicConfigurator replaced with PropertyConfigurator.</span></div><div class="line">            PropertyConfigurator::configure(argv[1]);</div><div class="line">        }</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">        {</div><div class="line">            BasicConfigurator::configure();</div><div class="line">        }</div><div class="line"></div><div class="line">        <a class="code" href="group__LoggingMacros.html#ga61dfed4f5eca82725a90a331f37857d3">LOG4CXX_INFO</a>(logger, <span class="stringliteral">&quot;Entering application.&quot;</span>);</div><div class="line">        Bar bar;</div><div class="line">        bar.doIt();</div><div class="line">        <a class="code" href="group__LoggingMacros.html#ga61dfed4f5eca82725a90a331f37857d3">LOG4CXX_INFO</a>(logger, <span class="stringliteral">&quot;Exiting application.&quot;</span>);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">catch</span>(<a class="code" href="classlog4cxx_1_1helpers_1_1Exception.html">Exception</a>&amp;)</div><div class="line">    {</div><div class="line">        result = EXIT_FAILURE;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> result;</div><div class="line">}</div></div><!-- fragment --><p>This version of <em>MyApp</em> instructs <em>PropertyConfigurator</em> to parse a configuration file and set up logging accordingly.</p>
<p>Here is a sample configuration file that results in exactly same output as the previous <em>BasicConfigurator</em> based example.</p>
<div class="fragment"><div class="line"># Set root logger level to DEBUG and its only appender to A1.</div><div class="line">log4j.rootLogger=DEBUG, A1</div><div class="line"></div><div class="line"># A1 is set to be a ConsoleAppender.</div><div class="line">log4j.appender.A1=org.apache.log4j.ConsoleAppender</div><div class="line"></div><div class="line"># A1 uses PatternLayout.</div><div class="line">log4j.appender.A1.layout=org.apache.log4j.PatternLayout</div><div class="line">log4j.appender.A1.layout.ConversionPattern=%-4r [%t] %-5p %c %x - %m%n</div></div><!-- fragment --><p>It can be noticed that the PropertyConfigurator file format is the same as log4j.</p>
<p>Suppose we are no longer interested in seeing the output of any component belonging to the <em>com::foo</em> package. The following configuration file shows one possible way of achieving this.</p>
<div class="fragment"><div class="line">log4j.rootLogger=DEBUG, A1</div><div class="line">log4j.appender.A1=org.apache.log4j.ConsoleAppender</div><div class="line">log4j.appender.A1.layout=org.apache.log4j.PatternLayout</div><div class="line"></div><div class="line"># Print the date in ISO 8601 format</div><div class="line">log4j.appender.A1.layout.ConversionPattern=%d [%t] %-5p %c - %m%n</div><div class="line"></div><div class="line"># Print only messages of level WARN or above in the package com.foo.</div><div class="line">log4j.logger.com.foo=WARN</div></div><!-- fragment --><p>The output of <em>MyApp</em> configured with this file is shown below.</p>
<div class="fragment"><div class="line">2000-09-07 14:07:41,508 [12345] INFO  MyApp - Entering application.</div><div class="line">2000-09-07 14:07:41,529 [12345] INFO  MyApp - Exiting application.</div></div><!-- fragment --><p>As the logger <em>com.foo.Bar</em> does not have an assigned level, it inherits its level from <em>com.foo</em>, which was set to WARN in the configuration file. The log statement from the <em>Bar::doIt</em> method has the level DEBUG, lower than the logger level WARN. Consequently, <em>doIt()</em> method's log request is suppressed.</p>
<p>Here is another configuration file that uses multiple appenders.</p>
<div class="fragment"><div class="line">log4j.rootLogger=debug, stdout, R</div><div class="line"></div><div class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</div><div class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</div><div class="line"></div><div class="line"># Pattern to output the caller&#39;s file name and line number.</div><div class="line">log4j.appender.stdout.layout.ConversionPattern=%5p [%t] (%F:%L) - %m%n</div><div class="line"></div><div class="line">log4j.appender.R=org.apache.log4j.RollingFileAppender</div><div class="line">log4j.appender.R.File=example.log</div><div class="line"></div><div class="line">log4j.appender.R.MaxFileSize=100KB</div><div class="line"># Keep one backup file</div><div class="line">log4j.appender.R.MaxBackupIndex=1</div><div class="line"></div><div class="line">log4j.appender.R.layout=org.apache.log4j.PatternLayout</div><div class="line">log4j.appender.R.layout.ConversionPattern=%p %t %c - %m%n</div></div><!-- fragment --><p>Calling the enhanced MyApp with the this configuration file will output the following on the console.</p>
<div class="fragment"><div class="line">INFO [12345] (MyApp2.cpp:31) - Entering application.</div><div class="line">DEBUG [12345] (Bar.h:16) - Doing it again!</div><div class="line">INFO [12345] (MyApp2.cpp:34) - Exiting application.</div></div><!-- fragment --><p>In addition, as the root logger has been allocated a second appender, output will also be directed to the <em>example.log</em> file. This file will be rolled over when it reaches 100KB. When roll-over occurs, the old version of <em>example.log</em> is automatically moved to <em>example.log.1</em>.</p>
<p>Note that to obtain these different logging behaviors we did not need to recompile code. We could just as easily have logged to a UNIX Syslog daemon, redirected all <em>com.foo</em> output to an NT Event logger, or forwarded logging events to a remote <a class="el" href="namespacelog4cxx.html">log4cxx</a> server, which would log according to local server policy, for example by forwarding the log event to a second <a class="el" href="namespacelog4cxx.html">log4cxx</a> server.</p>
<h1><a class="anchor" id="default-initialization-procedure"></a>
Default Initialization Procedure</h1>
<p>The <a class="el" href="namespacelog4cxx.html">log4cxx</a> library does not make any assumptions about its environment. In particular, there are no default <a class="el" href="namespacelog4cxx.html">log4cxx</a> appenders. Under certain well-defined circumstances however, the static inializer of the <em>Logger</em> class will attempt to automatically configure <a class="el" href="namespacelog4cxx.html">log4cxx</a>.</p>
<p>The exact default initialization algorithm is defined as follows:</p>
<ol type="1">
<li>Set the configurationOptionStr string variable to the value of the <b>LOG4CXX_CONFIGURATION</b> environment variable if set, otherwise the value of the <b>log4j.configuration</b> environment variable if set, otherwise the first of the following file names which exist in the current working directory, "log4cxx.xml", "log4cxx.properties", "log4j.xml" and "log4j.properties". If configurationOptionStr has not been set, then disable logging.</li>
<li>Unless a custom configurator is specified using the <b>LOG4CXX_CONFIGURATOR_CLASS</b> or <b>log4j.configuratorClass</b> environment variable, the PropertyConfigurator will be used to configure <a class="el" href="namespacelog4cxx.html">log4cxx</a> unless the file name ends with the ".xml" extension, in which case the DOMConfigurator will be used. If a custom configurator is specified, the environment variable should contain a fully qualified class name of a class that implements the Configurator interface.</li>
</ol>
<h1><a class="anchor" id="nested-diagnostic-contexts"></a>
Nested Diagnostic Contexts</h1>
<p>Most real-world systems have to deal with multiple clients simultaneously. In a typical multithreaded implementation of such a system, different threads will handle different clients. Logging is especially well suited to trace and debug complex distributed applications. A common approach to differentiate the logging output of one client from another is to instantiate a new separate logger for each client. This promotes the proliferation of loggers and increases the management overhead of logging.</p>
<p>A lighter technique is to uniquely stamp each log request initiated from the same client interaction. Neil Harrison described this method in the book "Patterns for Logging Diagnostic Messages," in <em>Pattern Languages of Program Design 3</em>, edited by R. Martin, D. Riehle, and F. Buschmann (Addison-Wesley, 1997).</p>
<p>To uniquely stamp each request, the user pushes contextual information into the NDC, the abbreviation of <em>Nested Diagnostic Context</em>. The NDC class is shown below.</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code" href="namespacelog4cxx.html">log4cxx</a> {</div><div class="line">    <span class="keyword">class </span>NDC {</div><div class="line">        <span class="keyword">public</span>:</div><div class="line">            <span class="comment">// pushes the value on construction and pops on destruction.</span></div><div class="line">            <a class="code" href="classlog4cxx_1_1NDC.html#acdcea9d742e026f9fa0c8927669e4917">NDC</a>(<span class="keyword">const</span> std::string&amp; value);</div><div class="line">            <a class="code" href="classlog4cxx_1_1NDC.html#acdcea9d742e026f9fa0c8927669e4917">NDC</a>(<span class="keyword">const</span> std::wstring&amp; value);</div><div class="line"></div><div class="line">            <span class="comment">// Remove the top of the context from the NDC.</span></div><div class="line">            <span class="keyword">static</span> <a class="code" href="namespacelog4cxx.html#aa2308ed05fef2a1366066cb38b177e94">LogString</a> <a class="code" href="classlog4cxx_1_1NDC.html#a617f0612ff8cc91d0bad7ea77aa7c0c2">pop</a>();</div><div class="line"></div><div class="line">            <span class="comment">// Add diagnostic context for the current thread.</span></div><div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classlog4cxx_1_1NDC.html#a6d9c7d1f558df31213bb4d7781643419">push</a>(<span class="keyword">const</span> std::string&amp; message);</div><div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classlog4cxx_1_1NDC.html#a6d9c7d1f558df31213bb4d7781643419">push</a>(<span class="keyword">const</span> std::wstring&amp; message);</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>The NDC is managed per thread as a <em>stack</em> of contextual information. Note that all methods of the <em><a class="el" href="classlog4cxx_1_1NDC.html" title="the ndc class implements nested diagnostic contexts as defined by neil harrison in the article &quot;patte...">log4cxx::NDC</a></em> class are static. Assuming that NDC printing is turned on, every time a log request is made, the appropriate <a class="el" href="namespacelog4cxx.html">log4cxx</a> component will include the <em>entire</em> NDC stack for the current thread in the log output. This is done without the intervention of the user, who is responsible only for placing the correct information in the NDC by using the <em>push</em> and <em>pop</em> methods at a few well-defined points in the code. In contrast, the per-client logger approach commands extensive changes in the code.</p>
<p>To illustrate this point, let us take the example of a servlet delivering content to numerous clients. The servlet can build the NDC at the very beginning of the request before executing other code. The contextual information can be the client's host name and other information inherent to the request, typically information contained in cookies. Hence, even if the servlet is serving multiple clients simultaneously, the logs initiated by the same code, i.e. belonging to the same logger, can still be distinguished because each client request will have a different NDC stack. Contrast this with the complexity of passing a freshly instantiated logger to all code exercised during the client's request.</p>
<p>Nevertheless, some sophisticated applications, such as virtual hosting web servers, must log differently depending on the virtual host context and also depending on the software component issuing the request. Recent <a class="el" href="namespacelog4cxx.html">log4cxx</a> releases support multiple hierarchy trees. This enhancement allows each virtual host to possess its own copy of the logger hierarchy.</p>
<h1><a class="anchor" id="performance"></a>
Performance</h1>
<p>One of the often-cited arguments against logging is its computational cost. This is a legitimate concern as even moderately sized applications can generate thousands of log requests. Much effort was spent measuring and tweaking logging performance. Log4cxx claims to be fast and flexible: speed first, flexibility second.</p>
<p>The user should be aware of the following performance issues.</p>
<ol type="1">
<li><p class="startli"><b>Logging performance when logging is turned off.</b></p>
<p class="startli">When logging is turned off entirely or just for a set of levels, the cost of a log request consists of a method invocation plus an integer comparison. The LOG4CXX_DEBUG and similar macros suppress unnecessary expression evaluation if the request is not enabled.</p>
</li>
<li><p class="startli"><b>The performance of deciding whether to log or not to log when logging is turned on.</b></p>
<p class="startli">This is essentially the performance of walking the logger hierarchy. When logging is turned on, <a class="el" href="namespacelog4cxx.html">log4cxx</a> still needs to compare the level of the log request with the level of the request logger. However, loggers may not have an assigned level; they can inherit them from the logger hierarchy. Thus, before inheriting a level, the logger may need to search its ancestors.</p>
<p class="startli">There has been a serious effort to make this hierarchy walk to be as fast as possible. For example, child loggers link only to their existing ancestors. In the <em>BasicConfigurator</em> example shown earlier, the logger named <em>com.foo.Bar</em> is linked directly to the root logger, thereby circumventing the nonexistent <em>com</em> or <em>com.foo</em> loggers. This significantly improves the speed of the walk, especially in "sparse" hierarchies.</p>
<p class="startli">The cost of walking the hierarchy is typically 3 times slower than when logging is turned off entirely.</p>
</li>
<li><p class="startli"><b>Actually outputting log messages</b></p>
<p class="startli">This is the cost of formatting the log output and sending it to its target destination. Here again, a serious effort was made to make layouts (formatters) perform as quickly as possible. The same is true for appenders.</p>
</li>
</ol>
<h1><a class="anchor" id="removing-log-statements"></a>
Removing log statements</h1>
<p>Sometimes, you may want to remove all log statements from your program, either for speed purposes or to remove sensitive information. This can easily be accomplished at build-time when using the standard <code>LOG4CXX_[level]</code> macros (<code>LOG4CXX_TRACE</code>, <code>LOG4CXX_DEBUG</code>, <code>LOG4CXX_INFO</code>, <code>LOG4CXX_WARN</code>, <code>LOG4CXX_ERROR</code>, <code>LOG4CXX_FATAL</code>).</p>
<p>Log statements can be removed either above a certain level, or they can be disabled entirely.</p>
<p>For example, if we want to remove all log statements within our program that use the <code>LOG4CXX_[level]</code> family of macros, add a preprocessor definition <code>LOG4CXX_THRESHOLD</code> set to 50001 or greater. This will ensure that any log statement that uses the <code>LOG4CXX_[level]</code>-macro will be compiled out of the program. To remove all log statements at <code>DEBUG</code> or below, set <code>LOG4CXX_THRESHOLD</code> to a value between 10001-20000.</p>
<p>The levels are set as follows:</p>
<table class="doxtable">
<tr>
<th>Logger Level</th><th>Integer Value  </th></tr>
<tr>
<td>TRACE </td><td>5000 </td></tr>
<tr>
<td>DEBUG </td><td>10000 </td></tr>
<tr>
<td>INFO </td><td>20000 </td></tr>
<tr>
<td>WARN </td><td>30000 </td></tr>
<tr>
<td>ERROR(1) </td><td>40000 </td></tr>
<tr>
<td>FATAL </td><td>50000 </td></tr>
</table>
<p>(1) The <code>LOG4CXX_ASSERT</code> macro is the same level as <code>LOG4CXX_ERROR</code></p>
<p>Note that this has no effect on other macros, such as using the <code>LOG4CXX_LOG</code>, <code>LOG4CXX_LOGLS</code>, or <code>LOG4CXX_L7DLOG</code> family of macros.</p>
<h1>Removing location information {#removing-location information}</h1>
<p>Whenever you log a message with Log4cxx, metadata about the location of the logging statement is captured as well through the preprocessor. This includes the file name, the method name, and the line number. If you would not like to include this information in your build but you still wish to keep the log statements, define <code>LOG4CXX_DISABLE_LOCATION_INFO</code> in your build system. This will allow log messages to still be created, but the location information will be invalid.</p>
<h1><a class="anchor" id="custom-types"></a>
Logging Custom Types</h1>
<p>Often, the data that needs to be logged is not just standard data types (such as int, string, etc), but amalgamations of those types in a data structure such as a class or struct. In order to log these custom types, simply override an <code>operator&lt;&lt;</code> function, the same as if you would print the custom type to <code>std::cout</code>. This can be accomplished by doing the following:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>MyStruct {</div><div class="line">    <span class="keywordtype">int</span> x;</div><div class="line">};</div><div class="line"></div><div class="line">std::ostream&amp; <a class="code" href="namespacelog4cxx_1_1helpers.html#ab162d7b97f908847986893a620dca5d8">operator&lt;&lt;</a>( std::ostream&amp; stream, <span class="keyword">const</span> MyStruct&amp; mystruct ){</div><div class="line">    stream &lt;&lt; <span class="stringliteral">&quot;[MyStruct x:&quot;</span> &lt;&lt; mystruct.x &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div><div class="line">    <span class="keywordflow">return</span> stream;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> someMethod(){</div><div class="line">    MyStruct mine;</div><div class="line">    mine.x = 90;</div><div class="line">    <a class="code" href="group__LoggingMacros.html#ga61dfed4f5eca82725a90a331f37857d3">LOG4CXX_INFO</a>( logger, <span class="stringliteral">&quot;Some important information: &quot;</span> &lt;&lt; mine );</div><div class="line">}</div></div><!-- fragment --><p>This will output data similar to the following:</p>
<div class="fragment"><div class="line">0 [0x7fd1eed63bc0] INFO root null - Some important information: [MyStruct x:90]</div></div><!-- fragment --><h1><a class="anchor" id="logging-with-fmt"></a>
Logging with {fmt}</h1>
<p>One issue with utilizing <a class="el" href="namespacelog4cxx.html">log4cxx</a> and its ostream style of logging is that log statements can be very awkward if you need to precisely format something:</p>
<div class="fragment"><div class="line"><a class="code" href="group__LoggingMacros.html#ga61dfed4f5eca82725a90a331f37857d3">LOG4CXX_INFO</a>( rootLogger, <span class="stringliteral">&quot;Numbers can be formatted with excessive operator&lt;&lt;: &quot;</span></div><div class="line">              &lt;&lt; std::setprecision(3) &lt;&lt; 22.456</div><div class="line">              &lt;&lt; <span class="stringliteral">&quot; And as hex: &quot;</span></div><div class="line">              &lt;&lt; std::setbase( 16 ) &lt;&lt; 123 );</div></div><!-- fragment --><p>This leads to very awkward code to read and write, especially as iostreams don't support positional arguments at all.</p>
<p>In order to get around this, one popular library(that has been standardized as part of C++20) is <a href="https://fmt.dev/latest/index.html">{fmt}</a>. Supporting positional arguments and printf-like formatting, it makes for much clearer code like the following:</p>
<div class="fragment"><div class="line"><a class="code" href="group__LoggingMacros.html#gae6c9cdbeef01d237af37a897beda825e">LOG4CXX_INFO_FMT</a>( rootLogger, <span class="stringliteral">&quot;Numbers can be formatted with a format string {:.1f} and as hex: {:x}&quot;</span>, 22.456, 123 );</div></div><!-- fragment --><p>Note that <a class="el" href="namespacelog4cxx.html">log4cxx</a> does not include a copy of {fmt}, so you must include the correct headers and linker flags in order to use the <code>LOG4CXX_[level]_FMT</code> family of macros.</p>
<p>As with the standard logger macros, these macros will also be compiled out if the <code>LOG4CXX_THRESHOLD</code> macro is set to a level that will compile out the non-FMT macros.</p>
<p>A full example can be seen in the src/examples/cpp/format-string.cpp file.</p>
<h1><a class="anchor" id="filtering"></a>
Filtering Messages</h1>
<p>When dealing with large amounts of logging information, it can be useful to filter on messages that we are interested in. This filtering only takes places after determining that the level of the current logger would log the message in the first place. When defining filters, note that they can only be defined on a per-appender basis, they do not globally affect anything.</p>
<p>The filtering system is similar in concept to Linux iptables rules, in that there is a chain of filters that can accept a log message, deny the log message, or pass the message on to the next filter. Accepting a log message means that the message will be logged immediately without consulting other filters. Denying has the opposite affect, immediately dropping the log message and not consulting any other filters.</p>
<p>See the documentation for Filter for some more information, or view a <a class="el" href="configuration-samples.html">configuration sample</a>.</p>
<h1><a class="anchor" id="conclusions"></a>
Conclusions</h1>
<p>Apache Log4cxx is a popular logging package written in C++. One of its distinctive features is the notion of inheritance in loggers. Using a logger hierarchy it is possible to control which log statements are output at arbitrary granularity. This helps reduce the volume of logged output and minimize the cost of logging.</p>
<p>One of the advantages of the <a class="el" href="namespacelog4cxx.html">log4cxx</a> API is its manageability. Once the log statements have been inserted into the code, they can be controlled with configuration files. They can be selectively enabled or disabled, and sent to different and multiple output targets in user-chosen formats. The <a class="el" href="namespacelog4cxx.html">log4cxx</a> package is designed so that log statements can remain in shipped code without incurring a heavy performance cost. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="usage-overview.html">Usage</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
    <li class="center">
Copyright &copy; 2003-2022 <a href="https://www.apache.org/">Apache Software Foundation</a>. All Rights Reserved. <br/>
Apache Logging, Apache Log4j, Log4j, Apache, the Apache feather logo, and the Apache Logging project logo are trademarks of The Apache Software Foundation.
    </li>
  </ul>
</div>
</body>
</html>
